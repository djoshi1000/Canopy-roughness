# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2022-08-29 11:03:10
"""
import arcpy
from arcpy.ia import *
import pandas as pd
import glob, os
arcpy.env.workspace = r"C:\Users\dpj20001\OneDrive - University of Connecticut\Documents\ArcGIS\Projects\MyProject6\MyProject6.gdb"


# To allow overwriting outputs change overwriteOutput option to True.
arcpy.env.overwriteOutput = True
#     temp = "C:\\Users\\dpj20001\\OneDrive - University of Connecticut\\Documents\\ArcGIS\\Projects\\MyProject6\\MyProject6.gdb\\temp"
df= pd.read_csv(r"E:\D_Drive\Project_data\Drive\Proximity_Tree_Pixels\tile_name.csv")
m=r"F:\Canopy_roughness"
n=r"F:\Deep_gaps"
# m= "E:\Hmax"
a=sorted(glob.glob(r"E:\D_Drive\Project_data\Drive\Proximity_Tree_Pixels\pPixLocs_ras\pPixLocs_ras\*.img"))
for x in a:
#         print(x)
    prox= x
    y= df.loc[df['P_name']==os.path.basename(x), 'NAME']
    rast=(m+'\\'+(y.values))[0]

    deeper=(n+'\\'+(y.values))[0]

    pPix = arcpy.Raster(prox)
    if os.path.isfile(rast):
        tif = arcpy.Raster(rast)
        tif1= arcpy.Raster(deeper)

#         tif = arcpy.Raster(rast)
#         tif1= arcpy.Raster(deeper)
        temp = "C:\\Users\\dpj20001\\OneDrive - University of Connecticut\\Documents\\ArcGIS\\Projects\\MyProject6\\MyProject6.gdb\\temp"
        temp2 = "C:\\Users\\dpj20001\\OneDrive - University of Connecticut\\Documents\\ArcGIS\\Projects\\MyProject6\\MyProject6.gdb\\temp1"
        dsc = arcpy.Describe(prox)
        dsc1= arcpy.Describe(rast)
        dsc2=arcpy.Describe(deeper)
        plsc= dsc.spatialReference.Name
        plsc1= dsc1.spatialReference.Name
        plsc2= dsc2.spatialReference.Name
        msc= arcpy.SpatialReference(plsc)
        msc1= arcpy.SpatialReference(plsc1)
        msc2= arcpy.SpatialReference(plsc2)

            # Process: Project Raster (Project Raster) (management)
        arcpy.management.ProjectRaster(in_raster=tif, 
                                       out_raster=temp, out_coor_system=msc, resampling_type="NEAREST", cell_size="4 4", 
                                       geographic_transform=[], Registration_Point="", in_coor_system=msc1, vertical="NO_VERTICAL")
        arcpy.management.ProjectRaster(in_raster=tif1, 
                                       out_raster=temp2, out_coor_system=msc, resampling_type="NEAREST", cell_size="4 4", 
                                       geographic_transform=[], Registration_Point="", in_coor_system=msc2, vertical="NO_VERTICAL")

        temp1 = arcpy.Raster(temp)
        temp3 = arcpy.Raster(temp2)

        # Process: Raster Calculator (Raster Calculator) (ia)
        new = "D:\\Canopy_rough\\"+os.path.basename(rast)
        print(new)
        deep= "D:\\Deep_Gap\\"+os.path.basename(deeper)
#         print(new, "  and  ", deep)
        Raster_Calculator = new
        Raster_Calculator1 = deep
        new =  ((pPix*0)+1)* temp1
        new.save(Raster_Calculator)
        new1 =  ((pPix*0)+1)* temp3
        new1.save(Raster_Calculator1)
        del temp
        del temp2
    else:
        print(rast, " Not found ")
        continue
 

# if __name__ == '__main__':
#     # Global Environment settings
#     with arcpy.EnvManager(scratchWorkspace=r"C:\Users\dpj20001\OneDrive - University of Connecticut\Documents\ArcGIS\Projects\MyProject6\MyProject6.gdb", 
#                           workspace=r"C:\Users\dpj20001\OneDrive - University of Connecticut\Documents\ArcGIS\Projects\MyProject6\MyProject6.gdb"):
#         Model1()
